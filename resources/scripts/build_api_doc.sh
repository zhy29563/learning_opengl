#!/bin/bash

########################################################################################################################
# 目录变量
########################################################################################################################
SCT_DIR=$(cd $(dirname $0) && pwd) # scripts
RES_DIR=$(dirname ${SCT_DIR})      # reources
PJT_DIR=$(dirname ${RES_DIR})      # repo
OUT_DIR=${PJT_DIR}/outputs         # outputs
DOC_DIR=${OUT_DIR}/doc             # 
########################################################################################################################
# 依赖库编译环境变量
########################################################################################################################
rm -rf ${DOC_DIR}

cd ${PJT_DIR}
doxygen ${PJT_DIR}/Doxyfile

cd ${OUT_DIR}/doc/latex
sed -i '/\\begin{document}/i\\\usepackage{CJKutf8}'    refman.tex
sed -i '/\\begin{document}/a\\\begin{CJK}{UTF8}{gkai}' refman.tex
sed -i '/\\end{document}/i\\\end{CJK}'                 refman.tex
make

cp refman.pdf ${OUT_DIR}/doc/api-manual.pdf
########################################################################################################################
# 结束
########################################################################################################################
pwd
echo "================================================================================================================="
echo
